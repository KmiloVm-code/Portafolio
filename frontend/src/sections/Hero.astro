---
import Console from "../components/Console.astro";
import ArrowRight from "@/assets/svg/arrow-right.astro";
import BrainCircuit from "@/assets/svg/brain-circuit.astro";
import Database from "@/assets/svg/database.astro";
import Terminal from "@/assets/svg/terminal.astro";
import CodeXml from "@/assets/svg/code-xml.astro";
---

<section
  id="hero"
  class="relative min-h-screen flex items-center pt-16 md:pt-20 overflow-hidden"
>
  <!-- Background Image Layer -->
  <div
    class="absolute inset-0 z-0 bg-cover bg-center bg-no-repeat opacity-60"
    style={{
      backgroundImage: "url('/hero-background.webp')",
    }}
  >
  </div>

  <!-- Dark Gradient Overlay for readability -->
  <div
    class="absolute inset-0 z-0 bg-linear-to-r from-[#050a14] via-[#050a14]/80 to-[#050a14]/30"
  >
  </div>
  <div
    class="absolute inset-0 z-0 bg-linear-to-t from-[#050a14] via-transparent to-transparent"
  >
  </div>

  <!-- Content -->
  <div class="container mx-auto px-6 md:px-12 lg:px-16 max-w-7xl relative z-10">
    <h1
      class="font-bold text-tertiary tracking-tight leading-[1.05] text-[clamp(2.25rem,6vw,4.5rem)] animate-fade-in-up"
    >
      Andrés Camilo
    </h1>
    <h2
      class="font-light text-secondary leading-snug mb-4 text-[clamp(1.5rem,3.6vw,3rem)] animate-fade-in-up animate-delay-100"
    >
      Full-Stack Developer
    </h2>
    <p
      class="prose prose-invert mt-2 mb-8 text-[clamp(1rem,1.2vw,1.25rem)] w-full sm:w-4/5 lg:w-1/2 max-w-[65ch] animate-fade-in-up animate-delay-200"
    >
      Desarrollo aplicaciones web escalables con React y Node.js, experiencia en
      Cloud (AWS/Azure) e IA aplicada al desarrollo para mejorar calidad y
      productividad.
    </p>
    <div class="flex flex-col sm:flex-row sm:items-center gap-4 mb-16 animate-fade-in-up animate-delay-300">
      <a
        href="/"
        data-section="proyectos"
        class="btn-line w-full sm:w-auto text-center hover:bg-accent-hover hover:text-bg px-6 py-3 gap-2 flex items-center justify-center font-semibold transition-all duration-300 group"
        >Ver Mis Proyectos
        <ArrowRight
          size="20"
          class="stroke-2 text-icon-secondary group-hover:text-icon-tertiary group-hover:translate-x-1 transition-all duration-300"
        />
      </a>
      <a
        href="/"
        data-section="contacto"
        class="btn-primary w-full sm:w-auto text-center bg-accent hover:bg-accent-hover text-bg px-6 py-3 font-semibold transition-all duration-300"
        >Contáctame
      </a>
    </div>

    {/* Skills Icons */}
    <div class="flex items-center gap-6 mx-auto justify-center sm:justify-start animate-fade-in-up animate-delay-400">
      <div class="flex flex-col items-center gap-2 group select-none">
        <CodeXml
          size="24"
          class="text-icon group-hover:text-icon-secondary transition-all duration-300"
        />
        <span
          class="text-xs text-secondary group-hover:text-accent transition-all duration-300"
        >
          Frontend
        </span>
      </div>
      <div class="w-px h-6 md:h-8 bg-slate-800"></div>
      <div class="flex flex-col items-center gap-2 group select-none">
        <Database
          size="24"
          class="text-icon group-hover:text-icon-secondary transition-all duration-300"
        />
        <span
          class="text-xs text-secondary group-hover:text-accent transition-all duration-300"
          >Backend
        </span>
      </div>
      <div class="w-px h-6 md:h-8 bg-slate-800"></div>
      <div class="flex flex-col items-center gap-2 group select-none">
        <Terminal
          size="24"
          class="text-icon group-hover:text-icon-secondary transition-all duration-300"
        />
        <span
          class="text-xs text-secondary group-hover:text-accent transition-all duration-300"
          >Devops
        </span>
      </div>
      <div class="w-px h-6 md:h-8 bg-slate-800"></div>
      <div class="flex flex-col items-center gap-2 group select-none">
        <BrainCircuit
          size="24"
          class="text-icon group-hover:text-icon-secondary transition-all duration-300"
        />
        <span
          class="text-xs text-secondary group-hover:text-accent transition-all duration-300"
          >AI Developer
        </span>
      </div>
    </div>

    {/* Code Overlay Layer (Decorative) */}
    <Console />
  </div>
</section>

<script>
  import { navigate } from "astro:transitions/client";

  // Función para manejar el scroll suave a una sección
  function scrollToSection(sectionId: string) {
    const targetElement = document.getElementById(sectionId);
    if (targetElement) {
      targetElement.scrollIntoView({
        behavior: "smooth",
        block: "start",
      });
    }
  }

  // Función para configurar los event listeners
  function setupHeroLinks() {
    document.querySelectorAll("a[data-section]").forEach((anchor) => {
      anchor.addEventListener("click", async (event) => {
        event.preventDefault();
        const sectionId = anchor.getAttribute("data-section");
        if (!sectionId) return;

        // Si estamos en la página principal, solo hacer scroll
        if (window.location.pathname === "/" || window.location.pathname === "") {
          scrollToSection(sectionId);
        } else {
          // Si estamos en otra página, navegar a la principal con View Transitions
          sessionStorage.setItem("scrollToSection", sectionId);
          await navigate("/");
        }
      });
    });
  }

  // Ejecutar en la carga inicial y después de cada navegación
  document.addEventListener("astro:page-load", () => {
    setupHeroLinks();

    // Si hay una sección guardada en sessionStorage, hacer scroll a ella
    const sectionToScroll = sessionStorage.getItem("scrollToSection");
    if (sectionToScroll) {
      sessionStorage.removeItem("scrollToSection");
      setTimeout(() => scrollToSection(sectionToScroll), 100);
    }
  });
</script>
