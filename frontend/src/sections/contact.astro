---
import Github from "@/assets/svg/github.astro";
import Linkedin from "@/assets/svg/linkedin.astro";
---

<section id="contacto" class="py-16 md:py-32 bg-bg relative">
  <div class="container mx-auto px-6 md:px-12 lg:px-16 max-w-7xl z-10">
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-20 lg:gap-32 items-center">
      <!-- Content -->
      <div class="prose prose-invert prose-a:no-underline mb-10 lg:mb-0 timeline-view animate-blurred-fade-in animate-range-[entry_10%_contain_30%]">
        <span
          class="text-xs font-bold font-mono text-accent tracking-widest uppercase  animate-fade-in-up">
          Let's Build Something
          </span
        >
        <h1
          class="text-5xl md:text-7xl font-bold leading-tight timeline-view animate-blurred-fade-in animate-range-[entry_10%_contain_30%]"
        >
          Contacto
        </h1>
        <p
          class="text-xl timeline-view animate-blurred-fade-in animate-range-[entry_10%_contain_30%]"
        >
          Estoy disponible para nuevos proyectos y colaboraciones estratégicas.
          Cuéntame tu visión y busquemos la mejor forma de ejecutarla.
        </p>

        <div
          class="flex gap-6 justify-between timeline-view animate-blurred-fade-in animate-range-[entry_10%_contain_30%]"
        >
          <a
            class="btn-line flex items-center justify-center gap-2 w-full hover:bg-accent-hover hover:text-bg"
            href="https://www.linkedin.com/in/andrescamilovelezmejia/"
            target="_blank"
            rel="noopener noreferrer"
          >
            <Linkedin />
            <span>LinkedIn</span>
          </a>

          <a
            class="btn-line flex items-center justify-center w-full gap-2 hover:bg-accent-hover hover:text-bg"
            href="https://github.com/KmiloVm-code"
            target="_blank"
            rel="noopener noreferrer"
          >
            <Github />
            <span>GitHub</span>
          </a>
        </div>
      </div>

      <!-- Form -->
      <div
        class="w-full timeline-view animate-blurred-fade-in animate-range-[entry_10%_contain_30%]"
      >
        <div
          class="bg-card/30 backdrop-blur-2xl border border-border p-10 md:p-14 rounded-[3rem] relative overflow-hidden shadow-2xl min-h-104 md:min-h-120"
        >
          <div
            id="form-wrapper"
            data-visible="true"
            class="space-y-8 transition-all duration-500 ease-out"
          >
            <form
              id="contact-form"
              method="post"
              action="/api/contact"
              class="space-y-8"
            >
              <div>
                <label
                  for="name"
                  class="block text-sm font-medium text-primary mb-2"
                  >Nombre</label
                >
                <input
                  type="text"
                  id="name"
                  name="name"
                  required
                  class="w-full px-4 py-3 rounded-lg bg-bg border border-border text-primary focus:outline-none focus:ring-2 focus:ring-accent focus:border-transparent"
                />
              </div>

              <div>
                <label
                  for="email"
                  class="block text-sm font-medium text-primary mb-2"
                  >Correo Electrónico</label
                >
                <input
                  type="email"
                  id="email"
                  name="email"
                  required
                  class="w-full px-4 py-3 rounded-lg bg-bg border border-border text-primary focus:outline-none focus:ring-2 focus:ring-accent focus:border-transparent"
                />
              </div>

              <div>
                <label
                  for="message"
                  class="block text-sm font-medium text-primary mb-2"
                  >Mensaje</label
                >
                <textarea
                  id="message"
                  name="message"
                  rows="4"
                  required
                  class="w-full px-4 py-3 rounded-lg min-h-32 bg-bg border border-border text-primary focus:outline-none focus:ring-2 focus:ring-accent focus:border-transparent"
                ></textarea>
              </div>

              <button
                type="submit"
                class="btn-primary w-full bg-accent text-bg rounded-lg hover:bg-accent/90 hover:-translate-y-0.5 shadow-md hover:shadow-accent/30 transition-all duration-300 disabled:opacity-70 disabled:cursor-not-allowed disabled:hover:translate-y-0"
                aria-busy="false"
              >
                <span class="inline-flex items-center justify-center gap-3">
                  <span class="btn-label">Enviar Mensaje</span>

                  <span class="btn-loading hidden items-center gap-3">
                    <span class="spinner" aria-hidden="true"></span>
                    <span>Enviando...</span>
                  </span>
                </span>
              </button>
            </form>
          </div>

          <div
            id="success-screen"
            data-visible="false"
            class="absolute inset-0 flex flex-col items-center justify-center gap-6 text-center text-primary"
          >
            <div
              class="flex h-24 w-24 items-center justify-center rounded-full border border-border-alt bg-border-alt/10 shadow-[0_0_25px_rgba(18,155,79,0.45)]"
            >
              <svg
                class="h-12 w-12 text-green-500"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
              >
                <path d="M20 6L9 17l-5-5"></path>
              </svg>
            </div>

            <div class="space-y-3">
              <h2 class="text-3xl font-bold text-primary">
                ¡Mensaje recibido!
              </h2>
              <p class="text-lg text-secondary">
                Analizaré tu propuesta y te contactaré lo antes posible.
              </p>
            </div>

            <button
              id="send-another"
              class="text-sm font-semibold uppercase tracking-[0.4em] text-accent hover:text-accent-hover hover:-translate-y-0.5 transition-all duration-300 cursor-pointer"
            >
              Enviar otro mensaje
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<script>
  import { initContactForm } from "@/scripts/contactForm";

  document.addEventListener("astro:page-load", initContactForm);
  document.addEventListener("astro:after-swap", initContactForm);
</script>

<style is:inline>
  #form-wrapper,
  #success-screen {
    transition:
      opacity 0.5s ease,
      transform 0.5s ease;
  }

  #form-wrapper[data-visible="false"] {
    opacity: 0;
    transform: translateY(20px);
    pointer-events: none;
    visibility: hidden;
  }

  #form-wrapper[data-visible="true"] {
    opacity: 1;
    transform: translateY(0);
    visibility: visible;
    pointer-events: auto;
  }

  #success-screen {
    pointer-events: none;
    opacity: 0;
    transform: translateY(-20px);
    visibility: hidden;
  }

  #success-screen[data-visible="true"] {
    opacity: 1;
    transform: translateY(0);
    visibility: visible;
    pointer-events: auto;
  }

  #send-another {
    transition:
      transform 0.3s ease,
      color 0.3s ease;
  }

  #send-another[data-animate="true"] {
    animation: successButtonPop 0.55s ease;
  }

  .spinner {
    width: 18px;
    height: 18px;
    border-radius: 9999px;
    border: 2px solid rgba(0, 0, 0, 0.25);
    border-top-color: rgba(0, 0, 0, 0.85);
    animation: spin 0.8s linear infinite;
  }

  @keyframes spin {
    to {
      transform: rotate(360deg);
    }
  }

  @keyframes successButtonPop {
    0% {
      opacity: 0;
      transform: translateY(8px) scale(0.95);
    }
    70% {
      opacity: 1;
      transform: translateY(0) scale(1.08);
    }
    100% {
      transform: translateY(0) scale(1);
    }
  }
</style>
